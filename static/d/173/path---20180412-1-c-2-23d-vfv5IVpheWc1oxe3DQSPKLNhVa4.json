{"data":{"site":{"siteMetadata":{"title":"Jon's Blog","author":""}},"markdownRemark":{"id":"fb2db006-fcff-57e0-b621-d4988dc1f8fe","excerpt":"先以root身份登录mysql mysql is a simple SQL shell with input line editing capabilities.算是个客户端. 给用户授予权限\nthis account can access the   database,\nbut only from the local…","html":"<p>先以root身份登录mysql</p>\n<p>mysql is a simple SQL shell with input line editing capabilities.算是个客户端.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">mysql -u root -p</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mysql&gt; create database coding666_dev;\nQuery OK, 1 row affected (0.07 sec)\n\nmysql&gt; show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| information_schema |\n| coding666_dev      |\n| mysql              |\n| performance_schema |\n| pets               |\n| sys                |\n+--------------------+\n6 rows in set (0.00 sec)\n\nmysql&gt;  CREATE USER &#39;coding666_dever&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;coding666_Dever&#39;;\nQuery OK, 0 rows affected (0.18 sec)</code></pre></div>\n<p>给用户授予权限\nthis account can access the <code class=\"language-text\">coding666_dev</code> database,\nbut only from the local host.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mysql&gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP\n    -&gt; ON coding666_dev.*\n    -&gt; TO &#39;coding666_dever&#39;@&#39;localhost&#39;;\nQuery OK, 0 rows affected (0.01 sec)</code></pre></div>\n<p>查看端口号</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mysql&gt; show global variables like &#39;port&#39;;\n+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| port          | 3306  |\n+---------------+-------+\n1 row in set (0.33 sec)</code></pre></div>\n<p>配置文件地址</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">~$ ls /etc/mysql/\nconf.d      debian-start  my.cnf.fallback  mysql.conf.d\ndebian.cnf  my.cnf        mysql.cnf</code></pre></div>\n<p>在<code class=\"language-text\">/etc/mysql/my.cnf</code>中有如下内容</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># - &quot;/etc/mysql/my.cnf&quot; to set global options,\n# - &quot;~/.my.cnf&quot; to set user-specific options.\n# \n# One can use all long options that the program supports.\n# Run program with --help to get a list of available options and with\n# --print-defaults to see which it would actually understand and use.\n#\n# For explanations see\n# http://dev.mysql.com/doc/mysql/en/server-system-variables.html\n\n#\n# * IMPORTANT: Additional settings that can override those from this file!\n#   The files must end with &#39;.cnf&#39;, otherwise they&#39;ll be ignored.\n#\n\n!includedir /etc/mysql/conf.d/\n!includedir /etc/mysql/mysql.conf.d/</code></pre></div>\n<p>据此,通过<code class=\"language-text\">less /etc/mysql/mysql.conf.d/mysqld.cnf</code>可查看到<code class=\"language-text\">port = 3306</code>.\n注意,此端口是<code class=\"language-text\">mysqld</code>的端口设置.</p>\n<p>总之,在/etc/mysql/下可以找到很多配置选项.文档[https://dev.mysql.com/doc/refman/5.7/en/option-files.html]</p>\n<p>例如,若修改<code class=\"language-text\">/etc/mysql/my.cnf</code>默认服务端端口如下:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[mysqld]\nport = 4444</code></pre></div>\n<p>重启服务后sequelize如果还使用最初的3306的话将无法连接,此时我们通过<code class=\"language-text\">mysql -u root -p</code>仍可以登录,然后<code class=\"language-text\">show global variables like &#39;port&#39;</code>可见端口为4444.</p>\n<p>这里有一点要提下,根据mysql5.7的manuel refrence</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">On Unix, MySQL programs treat the host name localhost specially, in a way that is likely different from what you expect compared to other network-based programs. For connections to localhost, MySQL programs attempt to connect to the local server by using a Unix socket file. This occurs even if a --port or -P option is given to specify a port number. To ensure that the client makes a TCP/IP connection to the local server, use --host or -h to specify a host name value of 127.0.0.1, or the IP address or name of the local server. You can also specify the connection protocol explicitly, even for localhost, by using the --protocol=TCP option. For example:\n\nshell&gt; mysql --host=127.0.0.1\nshell&gt; mysql --protocol=TCP</code></pre></div>\n<p>也就是说,在unix下,mysql程序对待<code class=\"language-text\">localhost</code>这个关键词的做法有点独特.一般情况下,<code class=\"language-text\">localhost</code>和<code class=\"language-text\">127.0.0.1</code>似乎是同义词可以互相替换的,但这里不行.</p>\n<p>如果我们通过<code class=\"language-text\">mysql --host=localhost</code>来连接,我们使用的就不是tcp/ip方式,即使通过<code class=\"language-text\">--port</code>指定接口也没用.要想mysql接入服务端的本地连接采取tcp/ip形式,必须用<code class=\"language-text\">--host:127.0.0.1</code>.</p>\n<p>因此,在此时我们服务端端口是4444的情况下,使用以下命令仍能连接</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">mysql --host<span class=\"token operator\">=</span>localhost -P 3307 -u root -p\nmysql --host<span class=\"token operator\">=</span>localhost -P 4444 -u root -p</code></pre></div>\n<p>因为我们没用tcp/ip连接,指定的<code class=\"language-text\">-P</code>接口压根没用.</p>\n<p>此时我们若想mysql这个命令行工具连入本地的mysql服务端采用tcp/ip形式,则需明确使用<code class=\"language-text\">127.0.0.1</code>并指明正确的端口号,如下:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mysql --host=127.0.0.1 -P 4444 -u root -p</code></pre></div>\n<p>ok.测试完成,我们将服务端port的默认值还修改回3306并重启服务.</p>","frontmatter":{"title":"mysql添加用户","date":"April 12, 2018","tags":null}}},"pageContext":{"previous":{"fields":{"urlPath":"/20180321"},"frontmatter":{"title":"CSS animation & Transition","publish":true,"tags":null}},"next":{"fields":{"urlPath":"/20180628"},"frontmatter":{"title":"promise一例","publish":true,"tags":["js","promise"]}}}}